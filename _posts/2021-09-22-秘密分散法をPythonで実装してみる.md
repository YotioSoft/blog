---
layout: post
title: 秘密分散法をPythonで実装してみる
tags: [Python]
excerpt_separator: <!--more-->
---

先日、大学のセキュリティの講義で習った「秘密分散法」という手法の仕組みが興味深かったので、実際にPythonで実装してみました。

<!--more-->



# 秘密分散法とは

一言で言えば暗号化の手法の一つ。暗号化したい平文を複数の「シェア（分散片とも言う）」と呼ばれるデータに分散して保管することで、頑強性と秘匿性を持たせるというもの。結構昔からある手法で、1979年にRSA暗号の提唱者の1人であるシャミア博士によって提唱されたようです。

## (k,n)閾値法

平文をn個のシェアに分散し、k個（任意の数）以上のシェアが揃えば復元できるようにする手法。つまり、分割したシェアのうち、全てが集まらなくても、k個集まればk個のシェアから1つの平文に復元できるというわけです。よってn-k個のシェアを紛失しても復元できるので、頑強性が確保されます。また、シェアがk個未満しか集まらなかった場合、復元はできないので秘匿性が確保されます。

## (k,n)閾値法のアルゴリズム（加法）

例として、(2,3)閾値法で考えてみます。つまり、k=2、n=3なので、合計3個のシェアがあって2個以上のシェアで復元できます。

### 1. 有限体を作る

まずは要素数pの有限体を作ります。  

$$ F_p={0,1,...,p-2,p-1} $$

ここでは仮にp=5とします。  
$$ F_p={0,1,2,3,4} $$

### 2. シェアを生成する

n=3個のシェアを生成します。シェアは次の数式で表されます。

$$ f(t)=S+A_1t+A_2t^2+…+A_{k-1}t^{k-1} $$
が成立するようにします。

